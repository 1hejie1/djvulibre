#C- This program is free software; you can redistribute it and/or 
#C- modify it under the terms of the GNU General Public License, 
#C- version 2.  The license should have accompanied the program 
#C- or you may obtain a copy of the license from the Free Software
#C- Foundation at http://www.fsf.org.
#C- 
#C- This program is distributed in the hope that it will be useful,
#C- but WITHOUT ANY WARRANTY; without even the implied warranty of
#C- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#C- GNU General Public License for more details.

@SET_MAKE@
SHELL = @SHELL@
VPATH = @srcdir@
INSTALL = @INSTALL@
LRELEASE = @LRELEASE@
RM = @RM@ 

srcdir = @srcdir@
top_srcdir = @top_srcdir@
top_builddir = ../..

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
datadir = @datadir@
libdir = @libdir@
mandir = @mandir@

man= ${DESTDIR}${mandir}/ja/man1
qm= ${DESTDIR}${datadir}/djvu/osi/ja_JP

MANFILES_STD= bzz.1 c44.1 cjb2.1 cpaldjvu.1 csepdjvu.1 \
              ddjvu.1 djvm.1 djvmcvt.1 djvu.1 djvudump.1 \
              djvuextract.1 djvumake.1 djvups.1 djvused.1 \
              djvuserve.1 djvutxt.1

@GUI_YES@MANFILES_GUI=nsdejavu.1 djview.1
@GUI_NO@MANFILES_GUI=

MANFILES= ${MANFILES_STD} ${MANFILES_GUI}

all clean distclean:

install: install-qm install-man

# QT2 does not come with lrelease
# We install precompiled versions of the qm files.
@GUI_NO@install-qm:
@GUI_YES@install-qm: FORCE
@GUI_YES@	-if test ${LRELEASE} = ":" ; then \
@GUI_YES@	     ${INSTALL} -d ${qm} ; \
@GUI_YES@	     ${INSTALL} -m 644 ${srcdir}/djview.qm ${qm} ; \
@GUI_YES@	     ${INSTALL} -m 644 ${srcdir}/qt.qm ${qm} ; \
@GUI_YES@	fi

# Install localized man pages
install-man: nsdejavu.1 FORCE
	-@${INSTALL} -d ${man}
	-for n in ${MANFILES} ; do \
	   if test -r $$n ; then \
	     ${INSTALL} -m 644 $$n ${man} ; fi ; \
	   if test -r ${srcdir}/$$n ; then \
	     ${INSTALL} -m 644 ${srcdir}/$$n ${man} ; fi ; \
	done

# Generate nsdejavu page.
nsdejavu.1: ${srcdir}/nsdejavu.1.in
	Lc_CTYPE=ja_JP.eucjp \
	  sed < ${srcdir}/nsdejavu.1.in > nsdejavu.1 \
	  -e 's,LIBDIR,${libdir},' -e 's,NSDEJAVUSO,${NSDEJAVU},'

FORCE:
.PHONY: FORCE


