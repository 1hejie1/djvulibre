#C- This program is free software; you can redistribute it and/or 
#C- modify it under the terms of the GNU General Public License, 
#C- version 2.  The license should have accompanied the program 
#C- or you may obtain a copy of the license from the Free Software
#C- Foundation at http://www.fsf.org.
#C- 
#C- This program is distributed in the hope that it will be useful,
#C- but WITHOUT ANY WARRANTY; without even the implied warranty of
#C- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#C- GNU General Public License for more details.

@SET_MAKE@
SHELL = @SHELL@
VPATH = @srcdir@
PACKAGE_NAME = @PACKAGE_NAME@
PACKAGE_VERSION = @PACKAGE_VERSION@

srcdir = @srcdir@
top_srcdir = @top_srcdir@
top_builddir = ../..

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
datadir = @datadir@
libdir = @libdir@
mandir = @mandir@
plugindir = ${libdir}/netscape/plugins

CC = @CC@
CXX = @CXX@
RM = @RM@
AR = @AR@
LN_S = @LN_S@
TOUCH = @TOUCH@
INSTALL = @INSTALL@
RANLIB = @RANLIB@
RPO = @RPO@

DEFS = @DEFS@ -DDEBUGLVL=0 -DPLUGIN -DXP_UNIX \
	-DUSE_EXCEPTION_EMULATION \
	-DDO_NOT_MOVE_GET_DATA_TO_ARRAYS_CPP \
	-DTHREADMODEL=NOTHREADS 

OPTS = @OPTS@

NSDEJAVU_PROGRAM = @NSDEJAVU_PROGRAM@
NSDEJAVU_LDFLAGS = @NSDEJAVU_LDFLAGS@
NSDEJAVU_LIBS = @NSDEJAVU_LIBS@

SOURCES = \
  ${srcdir}/plugin.cpp \
  ${srcdir}/stubs.cpp \
  ${srcdir}/path.cpp \
  ${top_srcdir}/gui/shared/utils/io.cpp \
  ${top_srcdir}/gui/shared/res/saved_data.cpp \
  ${top_srcdir}/gui/npsdk/npunix.cpp \
  ${top_srcdir}/libdjvu/GString.cpp \
  ${top_srcdir}/libdjvu/GException.cpp \
  ${top_srcdir}/libdjvu/GContainer.cpp \
  ${top_srcdir}/libdjvu/GSmartPointer.cpp \
  ${top_srcdir}/libdjvu/GThreads.cpp \
  ${top_srcdir}/libdjvu/Arrays.cpp 

all: ${NSDEJAVU_PROGRAM}

# Makefile.add contains
# - definition of variables OBJS and SRCINCS
#
# This file is generated by "make makeadd".
# One needs to update it after changing the makefile.in

include ${srcdir}/Makefile.add

makeadd: FORCE
	${SHELL} ${top_srcdir}/etc/makegen \
	  --srcdir=${srcdir} --top_srcdir=${top_srcdir} \
	  ${SOURCES} > ${srcdir}/Makefile.add

INCS = -I${top_builddir} ${SRCINCS}
FLAGS = ${DEFS} ${INCS} ${OPTS}
CFLAGS = @CFLAGS@ ${FLAGS}
CXXFLAGS = @CXXFLAGS@ ${CXXRPOFLAGS} ${FLAGS}

${NSDEJAVU_PROGRAM} : ${OBJS}
	@${RPO} ${OBJS}
	${CXX} -o $@ ${NSDEJAVU_LDFLAGS} ${OBJS} ${NSDEJAVU_LIBS}

install: ${NSDEJAVU_PROGRAM} FORCE
	${INSTALL} -d ${plugindir}
	${INSTALL} -s -m 0755 ${NSDEJAVU_PROGRAM} ${plugindir}	

depend: FORCE
	( for n in ${SOURCES} ; do \
	  ${CXX} -MM ${CXXFLAGS} $$n || exit ; done ) > Makefile.dep

clean: FORCE
	-${RM} 2>/dev/null *.o *.a *.so *.stamp

distclean: clean 
	-${RM} -r 2>/dev/null Makefile *.rpo ii_files

FORCE:
.PHONY: FORCE

# Dependencies

Makefile.dep: ${srcdir}/Makefile.dep
	cp ${srcdir}/Makefile.dep $@

include Makefile.dep



